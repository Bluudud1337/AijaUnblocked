<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AijaTube</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin: 0;
  background: black;
  color: white;
  font-family: Arial, sans-serif;
}

header {
  padding: 15px;
  background: #000;
  text-align: center;
}

input {
  width: 60%;
  padding: 12px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  outline: none;
}

#results {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 15px;
  padding: 20px;
}

.video {
  cursor: pointer;
  background: #111;
  border-radius: 10px;
  overflow: hidden;
}

.video img {
  width: 100%;
}

.video p {
  padding: 8px;
  font-size: 14px;
}

iframe {
  width: 100%;
  height: 60vh;
  border: none;
}
</style>
</head>

<body>

<header>
  <input
    id="search"
    placeholder="Search YouTube..."
    onkeydown="if(event.key==='Enter') searchVideos()"
  >
</header>

<div id="player"></div>
<div id="results"></div>

<script>
const INSTANCE = "https://invidious.fdn.fr"; // backup-safe instance

async function searchVideos() {
  const q = document.getElementById("search").value.trim();
  if (!q) return;

  const res = await fetch(`${INSTANCE}/api/v1/search?q=${encodeURIComponent(q)}&type=video`);
  const data = await res.json();

  const results = document.getElementById("results");
  results.innerHTML = "";

  data.slice(0, 20).forEach(v => {
    const div = document.createElement("div");
    div.className = "video";
    div.innerHTML = `
      <img src="${v.videoThumbnails?.[3]?.url || ""}">
      <p>${v.title}</p>
    `;
    div.onclick = () => playVideo(v.videoId);
    results.appendChild(div);
  });
}

function playVideo(id) {
  document.getElementById("player").innerHTML = `
    <iframe
      src="${INSTANCE}/embed/${id}"
      allowfullscreen
    ></iframe>
  `;
}
</script>

</body>
</html>
